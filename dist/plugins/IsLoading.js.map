{"version":3,"file":"IsLoading.js","sources":["../../src/plugins/IsLoading.js"],"sourcesContent":["/**\n * Copyright (c) 2024 Anthony Mugendi\n *\n * This software is released under the MIT License.\n * https://opensource.org/licenses/MIT\n */\n\nimport css from '../styles/plugins/loader.css';\n\nexport default class Plugin {\n  constructor(ctx) {\n    // inherit Scriptin (this.Scriptin) context which we will need\n    Object.assign(this, ctx);\n\n    ctx.showLoader = this.showLoader.bind(this);\n    ctx.hideLoader = this.hideLoader.bind(this);\n\n    this.dependencies = ['__styler', 'AutoResource'];\n\n  }\n\n  init() {\n    // Inject loading css to head\n    var head = document.head || document.body;\n    var style = document.createElement('style');\n    style.textContent = css;\n    head.appendChild(style);\n  }\n\n  showLoader(el) {\n    var loaderDiv = document.createElement('div');\n    loaderDiv.setAttribute('class', 'scriptin-loader');\n    loaderDiv.setAttribute('title', 'Scriptin loading ' + el.dataset.scriptin);\n    loaderDiv.setAttribute('data-loader', el.dataset.scriptin);\n    loaderDiv.innerHTML = '<div class=\"loader\"></div> ';\n\n    this.copyStyles(el, loaderDiv);\n\n    el.after(loaderDiv);\n    el.classList.add('scriptin-hidden');\n  }\n\n  hideLoader(el) {\n    // get loader\n    var loaderDiv = document.querySelector(\n      '[data-loader=\"' + el.dataset.scriptin + '\"]'\n    );\n    // remove\n    if (loaderDiv) loaderDiv.remove();\n    el.classList.remove('scriptin-hidden');\n  }\n\n  copyStyles(el, loaderDiv) {\n    var styles = window.getComputedStyle(el);\n    var cssText;\n\n    if (styles.cssText !== '') {\n      loaderDiv.style.cssText = styles.cssText;\n    } else {\n      cssText = Object.values(styles).reduce(\n        (css, propertyName) =>\n          `${css}${propertyName}:${styles.getPropertyValue(propertyName)};`\n      );\n\n      cssText =\n        cssText +\n        'min-width: 64px; min-height: 32px;  display: inline-block; margin: 2.5px;';\n\n      // apply custom styles\n      var customStyles = this.options?.plugins?.IsLoading?.styles || {};\n      if (typeof customStyles == 'object') {\n        for (var n in customStyles) {\n          cssText = cssText + n + ':' + customStyles[n] + ';';\n        }\n      }\n\n      loaderDiv.style.cssText = cssText;\n    }\n  }\n}\n"],"names":["Plugin","constructor","ctx","Object","assign","showLoader","bind","hideLoader","dependencies","init","head","document","body","style","createElement","textContent","css","appendChild","el","loaderDiv","setAttribute","dataset","scriptin","innerHTML","copyStyles","after","classList","add","querySelector","remove","styles","window","getComputedStyle","cssText","_this$options","values","reduce","propertyName","getPropertyValue","customStyles","options","plugins","IsLoading","n"],"mappings":"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"}